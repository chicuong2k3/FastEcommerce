@using IdentityServer8.Services
@using IdentityServer8.Stores
@using Microsoft.AspNetCore.Authentication
@using Microsoft.AspNetCore.Identity
@using IdentityServer.Data

@inject NavigationManager NavigationManager


<RadzenStack Gap="4px">
    <RadzenButton Text="@($"Đăng nhập với Facebook")"
                  ButtonStyle="ButtonStyle.Info"
                  Size="ButtonSize.Medium"
                  Variant="Variant.Flat" Style="width: 100%"
                  Click="@(() => ExternalLogin("Facebook"))" />
    <RadzenButton Text="@($"Đăng nhập với Google")"
                  ButtonStyle="ButtonStyle.Light"
                  Size="ButtonSize.Medium"
                  Variant="Variant.Flat" Style="width: 100%"
                  Click="@(() => ExternalLogin("Google"))" />
</RadzenStack>


@code {
    [Parameter]
    [SupplyParameterFromQuery]
    public string? ReturnUrl { get; set; }

    private void ExternalLogin(string provider)
    {
        NavigationManager.NavigateTo(NavigationManager.GetUriWithQueryParameters(
            NavigationManager.ToAbsoluteUri("Account/PerformExternalLogin").AbsoluteUri,
                new Dictionary<string, object?>()
                {
                    ["provider"] = provider,
                    ["returnUrl"] = ReturnUrl
                }), forceLoad: true);
    }

    public class ExternalLoginProvider
    {
        public string Name { get; set; } = string.Empty;
        public string? DisplayName { get; set; }
    }
}
